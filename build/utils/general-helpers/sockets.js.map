{"version":3,"sources":["../../../src/utils/general-helpers/sockets.js"],"names":["handleSocketConnectionError","handlePing","msg","socket","send","handleSocketClientDisconnect","connections","host","handshake","headers","off","checkConnection","req","res","next","status","locals"],"mappings":"AAAA,SAASA,2BAAT,QAA4C,8BAA5C;;AAEA,OAAO,MAAMC,aAAa,CAACC,GAAD,EAAMC,MAAN,KAAiB;AACzC,MAAID,QAAQ,MAAZ,EAAoB;AACpBC,SAAOC,IAAP,CAAY,MAAZ;AACD,CAHM;;AAKP,OAAO,MAAMC,+BAA+B,CAACF,MAAD,EAASG,WAAT,KAAyB;AACnE,QAAMC,OAAOJ,OAAOK,SAAP,CAAiBC,OAAjB,CAAyBF,IAAtC;AACA,SAAOD,YAAYC,IAAZ,CAAP;AACAJ,SAAOO,GAAP,CAAW,OAAX,EAAoBV,2BAApB;AACAG,SAAOO,GAAP,CAAW,SAAX,EAAsBT,UAAtB;AACD,CALM;;AAOP,OAAO,MAAMU,kBAAkB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAiBR,WAAjB,KAAiC;AAC9D,QAAMH,SAASG,YAAYM,IAAIH,OAAJ,CAAYF,IAAxB,CAAf;AACA,MAAI,CAACJ,MAAL,EAAa;AACXU,QAAIE,MAAJ,CAAW,GAAX,EAAgBX,IAAhB,CAAqB,6CAArB;AACA;AACD;AACDS,MAAIG,MAAJ,CAAWb,MAAX,GAAoBA,MAApB;AACAW;AACD,CARM","file":"sockets.js","sourcesContent":["import { handleSocketConnectionError } from \"../error-handlers/sockets.js\";\n\nexport const handlePing = (msg, socket) => {\n  if (msg !== \"ping\") return;\n  socket.send(\"pong\");\n};\n\nexport const handleSocketClientDisconnect = (socket, connections) => {\n  const host = socket.handshake.headers.host;\n  delete connections[host];\n  socket.off(\"error\", handleSocketConnectionError);\n  socket.off(\"message\", handlePing);\n};\n\nexport const checkConnection = (req, res, next, connections) => {\n  const socket = connections[req.headers.host];\n  if (!socket) {\n    res.status(404).send(\"No socket connection found for given client\");\n    return;\n  }\n  res.locals.socket = socket;\n  next();\n};\n"]}